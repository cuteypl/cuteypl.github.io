(function(){const headerBtn=document.getElementById('header-btn');const headerTips=document.getElementById('header-tips');const headerTipsLis=document.getElementsByClassName('header-tipsLi');const headerSwitchUls=document.getElementById('header-switch').getElementsByTagName('ul');const headerMenu=document.getElementById('header-menu');const headerCatory=document.getElementById('header-catory');const artOrProList=document.getElementById('artOrPro-list');const midPagenation=document.getElementById('mid-pagenation');const arrowUp=document.getElementById('arrow-up');const arrowDown=document.getElementById('arrow-down');var pageinfoData=null;var currentCategoryData=null;var productData=null;var persize=15;var type=1;pageinfoData=getPageOrProductInfoData('../json/pageinfo.json');addListIndex(headerTipsLis);addListIndex(headerMenu.getElementsByClassName('header-menuLi'));initCategoryNameList(headerCatory,pageinfoData);initPageOrProductList(artOrProList,pageinfoData.page,1,persize);initpagenation(midPagenation,getDataLenth(pageinfoData,1),persize);sessionStorage.setItem('pageinfoData',JSON.stringify(pageinfoData));headerBtn.addEventListener('click',function(e){toggleClass(headerTips,'block')});headerTips.addEventListener('click',function(e){targetShow(e,headerSwitchUls);toggleClass(headerTips,'block');});headerCatory.addEventListener('click',function(e){type=3,currentCategoryData=getCategoryData(e,pageinfoData.page);initCategoryTitleList(artOrProList,currentCategoryData,1,persize);initpagenation(midPagenation,currentCategoryData.data.length,persize);});headerMenu.addEventListener('click',function(e){switchHeaderMenu(e);});midPagenation.addEventListener('click',function(e){switchPageNation(e,artOrProList,persize,type)});arrowUp.addEventListener('click',toTop);arrowDown.addEventListener('click',toBottom);function addListIndex(eles){var i=0;for(i,len=eles.length;i<len;i++){eles[i].index=i;}}
function toggleClass(ele,classname){var classnameArr=ele.className.split(' ');var index=classnameArr.indexOf(classname);if(index===-1){classnameArr.push(classname);}
else{classnameArr.splice(index,1);}
ele.className=classnameArr.join(' ');}
function addClass(ele,classname){var classnameArr=ele.className.split(' ');var index=classnameArr.indexOf(classname);if(index===-1){classnameArr.push(classname);ele.className=classnameArr.join(' ');}}
function removeClass(ele,classname){var classnameArr=ele.className.split(' ');var index=classnameArr.indexOf(classname);if(index!==-1){classnameArr.splice(index,1);ele.className=classnameArr.join(' ');}}
function displayToggel(ele){if(!ele.style.display||ele.style.display==='none'){ele.style.display='block';}else{ele.style.display='none';}}
function targetShow(e,targetEles){var k=e.target.index;var i=0;for(i,len=targetEles.length;i<len;i++){targetEles[i].style.display='none';}
targetEles[k].style.display='block';}
function getPageOrProductInfoData(urlstr){var pageOrproductData=null;$.ajax({type:'GET',url:urlstr,async:false,success:function(data){pageOrproductData=data||[];}});console.log(pageOrproductData);return pageOrproductData;}
function initCategoryNameList(ele,data){var i=0,str='',len=data.category.length;var categoryArr=data.category;for(i;i<len;i++){str+='<li class="header-catoryLi">'+categoryArr[i]+'</li>';ele.innerHTML=str;}
console.log(str);}
function initPageOrProductList(ele,datas,pagenum,persize){var str='';var categoryNameArr=[],pagedataArr=[];var str1='';var index=(pagenum-1)*persize;var l=0,pageliArr=[],countArr=[];for(var i=0,len=datas.length;i<len;i++){pagedataArr=pagedataArr.concat(datas[i].data);l+=datas[i].data.length;if((l-index)<=0){continue;}
else{categoryNameArr.push(`<p class="list-category">`+datas[i].year+`</p>`);if((l-index)>=persize){countArr.push(persize);pageliArr=getpageList(pagedataArr,index,persize);break;}
else{countArr.push(l-index);pageliArr=getpageList(pagedataArr,index,l-index);continue;}}}
for(var i=0,len=countArr.length;i<len;i++){var count=i===0?countArr[i]:countArr[i]-countArr[i-1];str1='<ul class="list-wrap">$str</ul>'.replace('$str',pageliArr.splice(0,count).join(''));str+='<div class="artOrPro-inner">'+categoryNameArr[i]+str1+'</div>';}
ele.innerHTML=str;}
function getCategoryData(e,datas){var categoryName=e.target.innerHTML;var categorydata=[],k=0;for(var i=0,len=datas.length;i<len;i++){for(var j=0,len1=datas[i].data.length;j<len1;j++){if(datas[i].data[j].mark.includes(categoryName)){categorydata[k++]=datas[i].data[j]}}}
var obj={name:categoryName,data:categorydata};return obj;}
function initCategoryTitleList(ele,datas,pagenum,persize){var str=`<p class="list-category">$categoryName</p>`;var str1='';str=str.replace('$categoryName',datas.name);str1='<ul class="list-wrap">$str</ul>'.replace('$str',getpageList(datas.data,(pagenum-1)*persize,persize).join(''));str='<div class="artOrPro-inner">'+str+str1+'</div>';ele.innerHTML=str;}
function getpageList(data,index,count){var i=index,liArr=[],len=(data.length-(index+count))>0?(index+count):data.length;for(i;i<len;i++){liArr.push('<li><a href="'+data[i].url+'">'+data[i].title+'</a><time class="time-date">'+data[i].date+'</time></li>');}
return liArr;}
function getDataLenth(datas,type){var totalcount=0;if(type===1){datas=datas.page;for(var i=0,len=datas.length;i<len;i++){totalcount+=datas[i].data.length;console.log(totalcount);}}
else if(type===2){datas=datas.product;for(var i=0,len=datas.length;i<len;i++){totalcount+=datas[i].data.length;}}
else{totalcount=datas.length;}
return totalcount;}
function initpagenation(ele,countotal,persize){var pagecount=Math.ceil(countotal/persize);if(pagecount>1){var str=`<a href="#" class="pagenav-prev">&lt; prev</a>$str1<a href="#" class="pagenav-next">next &gt;</a> `;var str1='';for(var i=1;i<=pagecount;i++){str1+=`<a href="javascript:;" class="pagenav-num">`+i+`</a>`;}
ele.innerHTML=str.replace('$str1',str1);}
else{ele.innerHTML='';}}
function switchHeaderMenu(e){var index=e.target.index;if(index===0){if(type===2){}
type=1;initPageOrProductList(artOrProList,pageinfoData.page,1,persize);initpagenation(midPagenation,getDataLenth(pageinfoData,type),persize);}
else if(index===1){if(type===1){}
type=2;productData=getPageOrProductInfoData('../json/product.json');initPageOrProductList(artOrProList,productData.product,1,persize);initpagenation(midPagenation,getDataLenth(productData,type),persize);sessionStorage.setItem('productData',JSON.stringify(productData));}
else if(index===4){location.href='https://github.com/cuteypl';}}
function switchPageNation(e,ele,persize,type){if(e.target.nodeName==='A'){for(var i=0,len=e.currentTarget.children.length;i<len;i++){removeClass(e.currentTarget.children[i],'pagenav-active');}
var text=e.target.innerHTML;if(text==='&lt; prev'){text=e.target.nextSibling.innerHTML;addClass(e.target.nextSibling,'pagenav-active');}
else if(text==='next &gt;'){text=e.target.previousSibling.innerHTML;addClass(e.target.previousSibling,'pagenav-active');}
else{addClass(e.target,'pagenav-active');}
if(type===3){initCategoryTitleList(ele,currentCategoryData,parseInt(text),persize);}
else if(type===2){initPageOrProductList(ele,productData.product,parseInt(text),persize);}
else if(type===1){initPageOrProductList(ele,pageinfoData.page,parseInt(text),persize);}}}
function toTop(){scrollTo(0,0);}
function toBottom(){scrollTo(0,document.body.clientHeight);}})();