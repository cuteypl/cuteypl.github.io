(function(){var postId=location.href.split('=').pop();var pageinfoData=getPageOrProductInfoData('../json/pageinfo.json');var currentpageInfoData=getcurrentpageInfoData(pageinfoData.page);var urlstr='https://cuteypl.github.io/pages/page$postId.html'.replace('$postId',postId);var currentpageHtmlData=getcurrentpageHtmlData(urlstr);document.title=currentpageInfoData.title;document.head.innerHTML+=currentpageHtmlData.stylestr;document.getElementById('article-inner').innerHTML=currentpageHtmlData.bodystr;document.getElementById('article-mark').innerHTML=renderPageMark()+document.getElementById('article-mark').innerHTML;document.getElementById('article-info').innerHTML=renderPageInfo();document.getElementById('aside-list').innerHTML=renderPageTitleList();document.getElementById('list-btn').addEventListener('click',function(){toshowOrhiddenList(document.getElementById('aside-list'))});document.getElementById('arrow-up').addEventListener('click',toTop);document.getElementById('arrow-down').addEventListener('click',toBottom);document.getElementById('home-btn').addEventListener('click',function(){location.href='https://cuteypl.github.io'});document.getElementById('tool-comment').addEventListener('click',function(e){toshowOrhiddenList(document.getElementById('gitalk-container'));switchBgImg(e,'url("../images/comment1.png")')});document.getElementById('tool-praise').addEventListener('click',function(e){switchBgImg(e,'url("../images/love1.png")')});function getPageOrProductInfoData(urlstr){var pageOrproductData=null;$.ajax({type:'GET',url:urlstr,async:false,success:function(data){pageOrproductData=data||[];}});console.log(pageOrproductData);return pageOrproductData;}
function getcurrentpageInfoData(datas){console.log(datas);for(var i=0,len=datas.length;i<len;i++){var dataArr=datas[i].data;for(var j=0,len=dataArr.length;j<len;j++){if(dataArr[j].id===postId){return dataArr[j];}}}}
function getcurrentpageHtmlData(urlstr){var currentpageHtmlData=null;$.ajax({type:'GET',url:urlstr,async:false,dataType:String,success:function(data){currentpageHtmlData=data||'';}});if(currentpageHtmlData){var startindex=currentpageHtmlData.indexOf('<style>');var endindex=currentpageHtmlData.indexOf('</head>');var stylestr=currentpageHtmlData.substring(startindex,endindex).trim();startindex=currentpageHtmlData.indexOf('<body>');endindex=currentpageHtmlData.indexOf('</html>');bodystr=currentpageHtmlData.substring(startindex,endindex).trim();bodystr=bodystr.substring(6,bodystr.length-7);currentpageHtmlData={'stylestr':stylestr,'bodystr':bodystr};}
return currentpageHtmlData;}
function renderPageMark(){var str=`<span class="mark-img"></span>`;var str1='';for(var i=0,len=currentpageInfoData.mark.length;i<len;i++){str1+=`<span class="mark-category">`+currentpageInfoData.mark[i]+`</span>`;}
str+=str1;return str;}
function renderPageInfo(){var urlstr=currentpageInfoData.copyright==='原创'?currentpageInfoData.url:currentpageInfoData.url1;var str=`<span>发布时间：`+currentpageInfoData.date+`</span>
                    <a href="`+urlstr+`">`+currentpageInfoData.copyright+`</a>
                    <span>作者：`+currentpageInfoData.author+`</span>
                    <span>友情提示：转载请保留原文链接及作者</span>`;return str;}
function toshowOrhiddenList(ele){if(ele.style.display==='none'){ele.style.display='block';}
else{ele.style.display='none';}}
function renderPageTitleList(){var eles=document.getElementById('article-inner').children;var hEleArr=[];var hArr=['H1','H2','H3','H4','H5','H6'];var str='';for(var i=0,len=eles.length;i<len;i++){if(hArr.includes(eles[i].tagName)){hEleArr.push(eles[i]);}}
hEleArr.shift();for(var i=0,len=hEleArr.length;i<len;i++){str+=`<li class="list-item"><a href="#`+hEleArr[i].id+`">`+hEleArr[i].innerHTML+`</a></li>`;}
return str;}
function toTop(){scrollTo(0,0);}
function toBottom(){scrollTo(0,document.body.clientHeight);}
function switchBgImg(e,urlstr){if(!e.target.style.background){e.target.style.background=urlstr+'no-repeat center/20px 20px';}
else{e.target.style.background='';}}})();